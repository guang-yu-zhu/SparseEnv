<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Fit the envelope based sparse partial least squares model."><title>Fit the envelope based sparse partial least squares model. — spxenv • SparseEnv</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.7/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.7/font.css" rel="stylesheet"><link href="../deps/Roboto_Slab-0.4.7/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fit the envelope based sparse partial least squares model. — spxenv"><meta property="og:description" content="Fit the envelope based sparse partial least squares model."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">SparseEnv</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/guang-yu-zhu/spenv">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Fit the envelope based sparse partial least squares model.</h1>
      
      <div class="d-none name"><code>spxenv.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fit the envelope based sparse partial least squares model.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">spxenv</span><span class="op">(</span></span>
<span>  <span class="va">X</span>,</span>
<span>  <span class="va">Y</span>,</span>
<span>  <span class="va">u</span>,</span>
<span>  lambda1 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lambda2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ftol <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  maxiter <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  eps2 <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  init <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  asy <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  verbose <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  init_method <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  lambda_spice <span class="op">=</span> <span class="fl">0.1</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>X</dt>
<dd><p>Predictors. An n by p matrix, p is the number of predictors. The predictors can be univariate or multivariate, discrete or continuous.</p></dd>


<dt>Y</dt>
<dd><p>Multivariate responses. An n by r matrix, r is the number of responses and n is the number of observations. The responses must be continuous variables.</p></dd>


<dt>u</dt>
<dd><p>Dimension of the envelope. An integer between 0 and p.</p></dd>


<dt>lambda1</dt>
<dd><p>A user supplied lambda sequence for the first stage.</p></dd>


<dt>lambda2</dt>
<dd><p>A user supplied lambda sequence for the second stage.</p></dd>


<dt>ftol</dt>
<dd><p>Tolerance parameter for F. Default value: 1e-4.</p></dd>


<dt>maxiter</dt>
<dd><p>Maximum number of iterations. Default value: 100.</p></dd>


<dt>init</dt>
<dd><p>The initial value for the envelope subspace. An p by u matrix. Default value is the one generated by function initial_value.</p></dd>


<dt>verbose</dt>
<dd><p>Flag for print out model fitting process, logical 0 or 1. Default value: 0.</p></dd>


<dt>asym</dt>
<dd><p>Flag for calculating the asymptotic covariance of vec(beta) and asymptotic standard error for elements in beta for a fitted envelope model, logical 0 or 1. Default value: 0.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <dl><dt>mu</dt>
<dd><p>The estimated intercept in the envelope model. An r by 1 vector.</p></dd>

<dt>beta</dt>
<dd><p>The envelope estimator of the regression coefficients beta. A p by r matrix.</p></dd>

<dt>Gamma</dt>
<dd><p>The orthogonal basis of the envelope subspace. A p by u semi-orthogonal matrix.</p></dd>

<dt>Gamma0</dt>
<dd><p>The orthogonal basis of the complement of the envelope subspace. An p by p-u semi-orthogonal matrix.</p></dd>

<dt>eta</dt>
<dd><p>The coordinates of beta with respect to Gamma. A u by r matrix.</p></dd>

<dt>SigX</dt>
<dd><p>The envelope estimator of the covariance matrix of X. An p by p matrix.</p></dd>

<dt>Omega</dt>
<dd><p>The coordinates of Sigma with respect to Gamma. A u by u matrix.</p></dd>

<dt>Omega0</dt>
<dd><p>The coordinates of Sigma with respect to Gamma0. A p-u by p-u matrix.</p></dd>

<dt>sigYcX</dt>
<dd><p>The estimated conditional covariance matrix of Y given X. An r by r matrix.</p></dd>

<dt>loglik</dt>
<dd><p>The maximized log likelihood function. A real number.</p></dd>

<dt>paramNum</dt>
<dd><p>The number of parameters in the envelope model. A positive integer.</p></dd>

<dt>n</dt>
<dd><p>The number of observations in the data. A positive integer.</p></dd>

<dt>q</dt>
<dd><p>The number of active response variables. A positive integer.</p></dd>

<dt>iternum</dt>
<dd><p>The number of iterations. A positive integer.</p></dd>

<dt>lambda</dt>
<dd><p>The tuning parameters chosen by BIC.</p></dd>

<dt>where_1</dt>
<dd><p>The active responses chosen by the sparse envelope model.</p></dd>

<dt>where_0</dt>
<dd><p>The inactive responses chosen by the sparse envelope model.</p></dd>

<dt>BIC_seq1</dt>
<dd><p>The sequence of BIC in the first stage.</p></dd>

<dt>BIC_seq2</dt>
<dd><p>The sequence of BIC in the second stage.</p></dd>

<dt>covMatrix</dt>
<dd><p>The asymptotic covariance of vec(beta). An pr by pr matrix. The covariance matrix returned are asymptotic. For the actual standard errors, multiply by 1/n.</p></dd>

<dt>asySE</dt>
<dd><p>The asymptotic standard error for elements in beta under the envelope model. An p by r matrix. The standard errors returned are asymptotic, for actual standard errors, multiply by 1/sqrt(n).</p></dd>

<dt>ratio</dt>
<dd><p>The asymptotic standard error ratio of the standard multivariate linear regression estimator over the envelope estimator, for each element in beta. An r by p matrix.</p></dd>

<dt>fit_time</dt>
<dd><p>The time costs for fitting the envelope model.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function fits the sparse envelope model to the predictor using the maximum likelihood estimation. When the dimension of the envelope is between 1 and p-1, we implemented the algorithm in G. Zhu and Z. Su (2017). When the dimension is p, then the envelope model degenerates to the standard multivariate linear regression. When the dimension is 0, it means that X and Y are uncorrelated, and the fitting is different.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>#'
The codes are implemented based on the algorithm in Guangyu Zhu. Zhihua Su. "Envelope-based sparse partial least squares." Ann. Statist. 48 (1) 161 - 182, February 2020. <a href="https://doi.org/10.1214/18-AOS1796" class="external-link">
</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code>choose_spxenv</code> for choosing the dimension of envelope subspace and the tuning parameter.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>#'
Guangyu Zhu and Zhihua Su</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
</div>

    </footer></div>

  

  

  </body></html>

